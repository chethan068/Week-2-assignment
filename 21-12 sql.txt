1. Identify which salesperson has generated the highest total sales.

ans:   select s.snum,s.sname,sum(o.amt) as total from salespeople s join customer c on s.snum=c.snum join orders o on o.cnum=c.cnum group by s.snum,s.sname order by total desc limit 1;

2. Count how many customers are handled by each salesperson.

ans: select s.snum,s.sname,count(c.cnum) as count_c from salespeople s join customer c on s.snum=c.snum group by s.snum,s.sname;

3. Find out which customers have placed the most orders.

ans:    select c.cnum,c.cname,count(o.onum) as no_of_orders from customer c join orders o on c.cnum=o.cnum group by c.cnum,c.cname order by no_of_orders desc limit 1;

4. Analyze the average size of orders for each salesperson's customers.

ans:    select avg(amt),s.snum from salespeople s join customer c on s.snum=c.snum join orders o on o.cnum=c.cnum group by s.snum;

5. Identify the customers who have spent the most money on orders.
 ans:  select c.cname,SUM(o.amt) as Most_Spent from customer c join orders o on c.cnum=o.cnum group by c.cname order by Most_Spent limit 1;

6. Analyze which cities (regions) generate the highest total sales.
 ans:  select c.city,sum(o.amt) as total from customer c join orders o on o.cnum=c.cnum group by c.city order by total desc limit 1;

7. Find out which salesperson has the highest average customer rating.

ans:  select s.sname, avg(c.rating) as avg_rating from salespeople s join customer c on s.snum = c.snum group by s.sname order by avg_rating desc limit 1;

8. Calculate the percentage of customers who have placed orders for each salesperson.

ans:  select s.sname, count(distinct o.cnum) * 100.0 / count(distinct c.cnum) as percentage_of_customers_with_orders from salespeople s left join customer c on s.snum = c.snum left join orders o on c.cnum = o.cnum group by s.sname;

9. Calculate the total revenue generated by each customer.

ans:  select c.cnum, c.cname, sum(o.amt) as total_revenue from customer c join orders o on c.cnum = o.cnum group by c.cnum, c.cname;

10. Identify customers who have not placed any orders.

ans:  select c.cnum, c.cname from customer c left join orders o on c.cnum = o.cnum where o.onum is null;

11. Show the percentage of total revenue generated by each salesperson.
ans:  select s.sname, sum(o.amt) * 100.0 / (select sum(amt) from orders) as percentage_of_total_revenue from salespeople s join customer c on s.snum = c.snum join orders o on c.cnum = o.cnum group by s.sname;





 